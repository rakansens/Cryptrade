<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UI Events Test - Cryptrade</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            padding: 20px;
            background: #111;
            color: #fff;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        button {
            background: #00e676;
            color: #000;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
        }
        button:hover {
            background: #00c853;
        }
        .section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #333;
            border-radius: 8px;
        }
        h2 {
            color: #00e676;
            margin-top: 0;
        }
        .log {
            background: #1a1a1a;
            padding: 10px;
            border-radius: 4px;
            margin-top: 10px;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
        .log-entry {
            margin: 2px 0;
            padding: 2px 0;
            border-bottom: 1px solid #333;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¯ Cryptrade UI Events Test</h1>
        <p>FloatingChatPanelã®ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™</p>

        <div class="section">
            <h2>é€šè²¨ãƒšã‚¢å¤‰æ›´</h2>
            <button onclick="changeSymbol('BTCUSDT')">BTC/USDT</button>
            <button onclick="changeSymbol('ETHUSDT')">ETH/USDT</button>
            <button onclick="changeSymbol('SOLUSDT')">SOL/USDT</button>
            <button onclick="changeSymbol('ADAUSDT')">ADA/USDT</button>
        </div>

        <div class="section">
            <h2>æ™‚é–“è¶³å¤‰æ›´</h2>
            <button onclick="changeTimeframe('1m')">1åˆ†</button>
            <button onclick="changeTimeframe('5m')">5åˆ†</button>
            <button onclick="changeTimeframe('15m')">15åˆ†</button>
            <button onclick="changeTimeframe('1h')">1æ™‚é–“</button>
            <button onclick="changeTimeframe('4h')">4æ™‚é–“</button>
            <button onclick="changeTimeframe('1d')">æ—¥è¶³</button>
        </div>

        <div class="section">
            <h2>ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼åˆ¶å¾¡</h2>
            <button onclick="toggleIndicator('ma', true)">MAè¡¨ç¤º</button>
            <button onclick="toggleIndicator('ma', false)">MAéè¡¨ç¤º</button>
            <button onclick="toggleIndicator('rsi', true)">RSIè¡¨ç¤º</button>
            <button onclick="toggleIndicator('rsi', false)">RSIéè¡¨ç¤º</button>
            <button onclick="toggleIndicator('macd', true)">MACDè¡¨ç¤º</button>
            <button onclick="toggleIndicator('macd', false)">MACDéè¡¨ç¤º</button>
        </div>

        <div class="section">
            <h2>æç”»ãƒ„ãƒ¼ãƒ«</h2>
            <button onclick="drawTrendline()">ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³æç”»</button>
            <button onclick="drawFibonacci()">ãƒ•ã‚£ãƒœãƒŠãƒƒãƒæç”»</button>
            <button onclick="fitChart()">ãƒãƒ£ãƒ¼ãƒˆãƒ•ã‚£ãƒƒãƒˆ</button>
        </div>

        <div class="section">
            <h2>ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°</h2>
            <div id="log" class="log">
                <div class="log-entry">ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...</div>
            </div>
        </div>
    </div>

    <script>
        // ãƒ­ã‚°è¡¨ç¤º
        const logElement = document.getElementById('log');
        
        function addLog(message) {
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logElement.insertBefore(entry, logElement.firstChild);
            
            // æœ€å¤§50ä»¶ã¾ã§
            while (logElement.children.length > 50) {
                logElement.removeChild(logElement.lastChild);
            }
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ï¼ˆå‹•ä½œç¢ºèªç”¨ï¼‰
        window.addEventListener('ui:changeSymbol', (e) => {
            addLog(`âœ… Symbol Changed: ${e.detail.symbol}`);
        });
        
        window.addEventListener('ui:changeTimeframe', (e) => {
            addLog(`âœ… Timeframe Changed: ${e.detail.timeframe}`);
        });
        
        window.addEventListener('ui:toggleIndicator', (e) => {
            addLog(`âœ… Indicator Toggle: ${e.detail.indicator} = ${e.detail.enabled}`);
        });
        
        window.addEventListener('draw:trendline', (e) => {
            addLog(`âœ… Trendline Drawn: ${JSON.stringify(e.detail.points)}`);
        });
        
        window.addEventListener('draw:fibonacci', (e) => {
            addLog(`âœ… Fibonacci Drawn: ${JSON.stringify(e.detail.points)}`);
        });
        
        window.addEventListener('chart:fitContent', () => {
            addLog(`âœ… Chart Fit Requested`);
        });

        // ãƒ†ã‚¹ãƒˆé–¢æ•°
        function changeSymbol(symbol) {
            const event = new CustomEvent('ui:changeSymbol', {
                detail: { symbol }
            });
            window.dispatchEvent(event);
            addLog(`ğŸ“¤ Dispatched: ui:changeSymbol - ${symbol}`);
        }

        function changeTimeframe(timeframe) {
            const event = new CustomEvent('ui:changeTimeframe', {
                detail: { timeframe }
            });
            window.dispatchEvent(event);
            addLog(`ğŸ“¤ Dispatched: ui:changeTimeframe - ${timeframe}`);
        }

        function toggleIndicator(indicator, enabled) {
            const event = new CustomEvent('ui:toggleIndicator', {
                detail: { indicator, enabled }
            });
            window.dispatchEvent(event);
            addLog(`ğŸ“¤ Dispatched: ui:toggleIndicator - ${indicator} = ${enabled}`);
        }

        function drawTrendline() {
            // ã‚µãƒ³ãƒ—ãƒ«ãƒã‚¤ãƒ³ãƒˆï¼ˆå®Ÿéš›ã®ãƒãƒ£ãƒ¼ãƒˆã‹ã‚‰å–å¾—ã•ã‚Œã‚‹ã¹ãï¼‰
            const points = [
                { x: 100, y: 200, price: 105000, time: Date.now() - 3600000 },
                { x: 300, y: 150, price: 106000, time: Date.now() }
            ];
            
            const event = new CustomEvent('draw:trendline', {
                detail: { 
                    points,
                    style: {
                        color: '#00e676',
                        lineWidth: 2,
                        lineStyle: 'solid',
                        showLabels: true
                    }
                }
            });
            window.dispatchEvent(event);
            addLog(`ğŸ“¤ Dispatched: draw:trendline`);
        }

        function drawFibonacci() {
            // ã‚µãƒ³ãƒ—ãƒ«ãƒã‚¤ãƒ³ãƒˆ
            const points = [
                { x: 50, y: 250, price: 104000, time: Date.now() - 7200000 },
                { x: 350, y: 100, price: 107000, time: Date.now() }
            ];
            
            const event = new CustomEvent('draw:fibonacci', {
                detail: { 
                    points,
                    style: {
                        color: '#ff9800',
                        lineWidth: 1,
                        lineStyle: 'solid',
                        showLabels: true
                    }
                }
            });
            window.dispatchEvent(event);
            addLog(`ğŸ“¤ Dispatched: draw:fibonacci`);
        }

        function fitChart() {
            const event = new CustomEvent('chart:fitContent', {});
            window.dispatchEvent(event);
            addLog(`ğŸ“¤ Dispatched: chart:fitContent`);
        }

        // åˆæœŸãƒ­ã‚°
        addLog('ğŸš€ UI Events Test Ready');
        addLog('â„¹ï¸ ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã‚¤ãƒ™ãƒ³ãƒˆã‚’ãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒã—ã¦ãã ã•ã„');
    </script>
</body>
</html>